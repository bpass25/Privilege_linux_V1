import requests
from bs4 import BeautifulSoup
from termcolor import colored
def ex_info_su(commands):
    url = f"https://gtfobins.github.io/gtfobins/{commands}/"
    try:
        req = requests.get(url, timeout=10)
    except requests.RequestException:
        print(colored(f"{commands} → Failed","red"))
        return


    soup = BeautifulSoup(req.text, 'html.parser')

    if "File not found" in req.text:
        print(colored(f"{commands} → No Vulnerability","red"))
    else:
        for h2 in soup.find_all("h2", class_="function-name"):
            hid = h2.get("id")
            pre = h2.find_next("pre")
            print("TYPE:", hid)
            if pre:
                print(colored("EXPLOIT : " + "\n" + pre.get_text("\n", strip=True),"green"))
                print(colored("....................................", "green"))

